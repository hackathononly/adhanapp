---
import Constants from "../constants";
const { states, zones } = Astro.props;
const { zone } = Astro.params;
import "../styles/animation.scss";

const zoneParam = zone ? zone : Constants.defaultSettings.zone;
---

<div id="daerahList">
	<div class="overflow-y-auto w-max">
		<div class="stats py-2 overflow-hidden -ml-5">
			{
				zones.map((zone: any) => (
					<div id={"zone-" + zone[0]} class="w-48 relative stat pt-0 pb-0">
						<div class="stat-figure text-gray-400 bg-base-300">
							<a
								role="button"
								href="javascript:;"
								tabindex="0"
								class="absolute bottom-0 left-6 z-50"
								title={"Set " + zone[0] + " as default location"}
							>
								<input
									id={"toggle-heart_" + zone[0]}
									data-zone={zone[0]}
									type="checkbox"
								/>
								<label
									for={"toggle-heart_" + zone[0]}
									aria-label="like"
									class="inline-block w-2 h-2 stroke-current"
								>
									<span class="text-sm">â™¥</span>
								</label>{" "}
							</a>
						</div>
						<a class="pb-6" href={"/" + states + "/" + zone[0]}>
							<span
								class={
									"inline-block text-xs flex-initial break-words " +
									(zone.indexOf(zoneParam) == 0
										? "text-white"
										: "text-gray-500")
								}
							>
								{zone[1]}
							</span>
						</a>
					</div>
				))
			}
		</div>
	</div>
</div>

<script>
	const checkboxContainer = document.querySelector(".stats"),
		checkboxes = checkboxContainer.querySelectorAll('input[type="checkbox"]');

	checkboxes.forEach(function (checkbox) {
		checkbox.addEventListener("change", (event) => {
			if (event !== null && event.target instanceof HTMLElement) {
				if (localStorage.getItem("selectedZone") === null) {
					// has record
					return JSON.parse(localStorage.getItem("selectedZone"));
				} else {
					// no record
					localStorage.setItem(
						"selectedZone",
						JSON.stringify(event.target.dataset.zone),
					);
				}
			}
		});
	});
</script>
